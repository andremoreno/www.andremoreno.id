---
title: "The target='_blank' vulnerability"
date: 2017-02-12
image: images/blog/target-blank-vulnerability-thumb.jpg
feature_image: images/blog/target-blank-vulnerability-details.jpg
author: Andre Moreno
---

### The Example

{{< codepen
    id="LYwMmjR"
    author="ndrmrn"
    theme="light"
    tab="result"
    >}}



### The problem

People using target='_blank' links usually have no idea about this curious fact:

The linked page gains partial access to the linking page via the window.opener object.

The newly opened tab can then change the window.opener.location to some phishing page. Users trust the page that is already opened, they won't get suspicious.

### Example attack scenario

Create a fake "viral" page with cute cat pictures, jokes or whatever, get it shared on Facebook (which is known for opening links via _blank).
Create a "phishing" website at https://fakewebsite/facebook.com/page.html for example
Put this code into your "viral" page
{{< highlight html "linenos=table" >}}
window.opener.location = 'https://fakewebsite/facebook.com/page.html';
{{< / highlight >}}
which redirects the Facebook tab to your phishing page, asking the user to re-enter their Facebook password.
How to fix
Add this to your outgoing links.

{{< highlight html "linenos=table" >}}
rel="noopener"
{{< / highlight >}}
Update: FF does not support "noopener" so add this.

{{< highlight html "linenos=table" >}}
rel="noopener noreferrer"
{{< / highlight >}}

Remember, that every time you open a new window via window.open(); you're also "vulnerable" to this, so always reset the "opener" property
{{< highlight html "linenos=table" >}}
var newWnd = window.open();
newWnd.opener = null;
{{< / highlight >}}
PS. Interestingly, Google doesn't seem to care.